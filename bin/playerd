#!/usr/bin/env python
import argparse
import importlib
import logging
import sys

from soundfleet_player.conf import settings
from soundfleet_player.player import Player


def parse_args():
    parser = argparse.ArgumentParser()
    parser.add_argument("--log-level", dest="log_level")
    args = parser.parse_args()
    return args


def main():
    media_backend_module = importlib.import_module(settings.MEDIA_BACKEND)
    player = Player(media_backend_module.MediaBackend())
    player.run()


if __name__ == "__main__":
    args = parse_args()
    log_level = args.log_level and getattr(logging, args.log_level) or logging.INFO
    logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)
    main()
